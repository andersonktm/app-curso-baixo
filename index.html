<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>L√≥gica do Groove</title>
    
    <link rel="manifest" href="manifest.json" />
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.0.6/purify.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Poppins:wght@500;700&display=swap" rel="stylesheet" />
    
    <link rel="stylesheet" href="style.css?v=14" />
</head>
<body>

    <div id="login-screen">
        <div class="login-box">
            <div class="login-logo-area">
                <img src="logo.png" alt="Logo L√≥gica do Groove" class="login-img">
            </div>

            <h2 class="login-title">√Årea do Aluno</h2>

            <form id="login-form">
                <div class="input-group">
                    <input type="email" id="email" class="login-input" placeholder=" " required>
                    <label for="email">E-mail</label>
                </div>
                <div class="input-group">
                    <input type="password" id="password" class="login-input" placeholder=" " required>
                    <label for="password">Senha</label>
                </div>
                
                <button type="submit" id="btnLogin" class="login-btn">ENTRAR NA √ÅREA DO ALUNO</button>
            </form>
            
            <p id="error-msg" class="error-msg"></p>
        </div>
    </div>

    <div id="app-container">
        
        <aside id="sidebar">
            <div class="logo-area">
                <h1>L√≥gica do Groove</h1>
                <button class="mobile-menu-close" onclick="toggleMobileMenu()">‚úï</button>
            </div>

            <div class="sidebar-scroll-area">
                <div class="tools-area">
                    <button class="btn-metronome" onclick="toggleMetronome()"><span>‚è±Ô∏è</span> Metr√¥nomo</button>
                    <button class="btn-map" onclick="toggleMap()"><span>üó∫Ô∏è</span> Mapa de Estudo</button>
                    
                    <button class="btn-games" onclick="toggleGamesMenu()"> 
                        <span>üéÆ Jogos & Treinos</span> <span id="games-arrow">‚ñº</span>
                    </button>
                    <div id="games-submenu">
                        <button class="sub-item" onclick="window.location.href='game.html'"><span>üéº</span> Treino de Notas</button>
                        <button class="sub-item" onclick="window.location.href='flashcards.html'"><span>üÉè</span> Flashcards Intervalos</button>
                        <button class="sub-item" onclick="window.location.href='ear_training.html'"><span>üëÇ</span> Treino de Intervalos</button>
                        <button class="sub-item" onclick="window.location.href='songs.html'"><span>üé∂</span> Interval Songs</button>
                        <button class="sub-item" onclick="window.location.href='jogo_virus.html'"><span>ü¶†</span> Desafio V√≠rus</button>
                    </div>
                </div>

                <div id="menu-container"></div>
            </div>

            <div class="sidebar-footer">
                <button class="btn-logout" id="btnLogout">üö™ Sair</button>
            </div>
        </aside>

        <main id="content">
            <div class="mobile-header">
                <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">‚ò∞</button>
                <span class="mobile-title">L√≥gica do Groove</span>
            </div>

            <div class="container">
                <div class="breadcrumb" id="display-module">Painel</div>
                <h2 class="lesson-title" id="display-title">Bem-vindo</h2>

                <div id="study-timer" class="timer-box" style="display: none">
                    <div style="display: flex; flex-direction: column">
                        <span style="font-size: 0.8rem; text-transform: uppercase; letter-spacing: 1px; opacity: 0.8;">Tempo de Pr√°tica</span>
                        <span id="timer-display" class="timer-display">00:00</span>
                    </div>
                    <button id="btn-timer" class="timer-btn" onclick="toggleStudyTimer()">‚ñ∂ INICIAR</button>
                </div>

                <div class="image-container" id="img-box" style="display: none;">
                    <img id="display-img" src="" alt="Diagrama" />
                </div>

                <div class="lesson-text" id="display-text">Selecione uma aula no menu.</div>

                <div id="audio-container" class="audio-section" style="display: none">
                    <div class="audio-row" id="row-bass">
                        <span class="audio-label">üé∏ Baixo Isolado:</span>
                        <audio id="player-bass" controls controlsList="nodownload"><source src="" type="audio/mpeg" /></audio>
                    </div>
                    <div class="audio-row" id="row-backing">
                        <span class="audio-label">ü•Å Backing Track:</span>
                        <audio id="player-back" controls controlsList="nodownload"><source src="" type="audio/mpeg" /></audio>
                    </div>
                </div>

                <div class="progress-box" id="progress-area" style="display: none">
                    <label class="progress-label">PROGRESSO: <span id="progress-val" class="progress-value">0%</span></label>
                    <input type="range" id="progress-slider" class="progress-slider" min="0" max="100" value="0" />
                </div>

                <div class="nav-buttons">
                    <button id="btn-prev" class="nav-btn" onclick="changeLesson(-1)">‚¨Ö Anterior</button>
                    <button id="btn-next" class="nav-btn" onclick="changeLesson(1)">Pr√≥ximo ‚û°</button>
                </div>
            </div>
        </main>
    </div>

    <div id="metronome-modal">
        <div class="modal-content" style="text-align: center; padding: 20px; max-width: 700px">
            <button class="close-modal" onclick="toggleMetronome()">X</button>
            <h2 style="color: #2c3e50; margin-top: 0">Metr√¥nomo Pro</h2>
            
            <div class="metro-controls">
                <div>
                    <label style="font-weight: bold; color: #7f8c8d">Compasso:</label>
                    <select id="time-sig" class="metro-select" onchange="generateSteps()">
                        <option value="4/4">4/4 (Rock/Pop)</option>
                        <option value="2/4">2/4 (Samba/Polka)</option>
                        <option value="2/2">2/2 (Cut Time)</option>
                        <option value="3/4">3/4 (Valsa)</option>
                        <option value="5/4">5/4 (Jazz/Fusion)</option>
                        <option value="6/8">6/8 (Blues/Jazz)</option>
                        <option value="9/8">9/8 (Compound)</option>
                        <option value="12/8">12/8 (Slow Blues)</option>
                        <option value="7/4">7/4 (Prog)</option>
                    </select>
                </div>
                <div style="font-size: 2rem; font-weight: bold; color: #e67e22">
                    <span id="bpm-val">100</span>
                    <span style="font-size: 1rem; color: #7f8c8d">BPM</span>
                </div>
            </div>

            <p style="font-size: 0.8rem; color: #666; margin: 0">
                Toque nas barras: Mudo > Fraco (Roxo) > Forte (Azul)
            </p>
            
            <div id="sequencer-track" class="sequencer-container"></div>
            
            <input type="range" id="bpm-range" min="40" max="220" value="100" 
                   style="width: 100%; margin: 20px 0; cursor: pointer" 
                   oninput="updateBpm(this.value)" />
            
            <button id="btn-play-metro" onclick="togglePlayMetronome()" 
                    style="background: #2c3e50; color: white; border: none; padding: 15px 50px; font-size: 1.2rem; border-radius: 50px; cursor: pointer; transition: 0.2s;">
                ‚ñ∂ INICIAR
            </button>
        </div>
    </div>

    <div id="map-modal">
        <div class="modal-content" style="width:95%; max-width:1000px; height:90%; background:white; padding:10px; display:flex; flex-direction:column;">
            <div style="display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid #eee; padding-bottom:10px;">
                <h2 style="margin:0; color:#2c3e50">Mapa de Evolu√ß√£o</h2>
                <button class="close-modal" style="position:static" onclick="toggleMap()">X</button>
            </div>
            <div id="roadmap-container" style="flex:1; overflow:auto; display:flex; justify-content:center;">
                <div class="mermaid" id="mermaid-graph"></div>
            </div>
        </div>
    </div>

    <script src="script.js?v=16"></script>
    <script type="module" src="firebase.js?v=16"></script>
</body>
</html>